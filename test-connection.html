<!DOCTYPE html>
<html>
<head>
    <title>Test Connection</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        #status {
            padding: 20px;
            margin: 10px 0;
            border-radius: 10px;
            background: #333;
        }
        .success { background: #2d5; color: #fff; }
        .error { background: #d52; color: #fff; }
        .pending { background: #fa5; color: #000; }
    </style>
</head>
<body>
    <h1>üß™ Monkey Flipper - Connection Test</h1>
    <div id="status" class="pending">‚è≥ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...</div>
    <div id="logs"></div>

    <script src="https://cdn.socket.io/4.6.1/socket.io.min.js"></script>
    <script>
        const statusDiv = document.getElementById('status');
        const logsDiv = document.getElementById('logs');

        function log(msg, isError = false) {
            const time = new Date().toLocaleTimeString();
            const p = document.createElement('p');
            p.textContent = `[${time}] ${msg}`;
            p.style.color = isError ? '#f55' : '#5f5';
            logsDiv.appendChild(p);
            console.log(msg);
        }

        // URL —Å–µ—Ä–≤–µ—Ä–∞
        const SERVER_URL = 'https://monkey-flipper.onrender.com';
        
        log('üîó –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É: ' + SERVER_URL);

        // –°–æ–∑–¥–∞—ë–º Socket.IO —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
        const socket = io(SERVER_URL, {
            transports: ['websocket', 'polling'],
            reconnection: true,
            reconnectionDelay: 1000,
            reconnectionAttempts: 5
        });

        socket.on('connect', () => {
            log('‚úÖ –£–°–ü–ï–®–ù–û –ø–æ–¥–∫–ª—é—á–µ–Ω –∫ —Å–µ—Ä–≤–µ—Ä—É!');
            log('Socket ID: ' + socket.id);
            statusDiv.textContent = '‚úÖ –°–µ—Ä–≤–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç! Socket ID: ' + socket.id;
            statusDiv.className = 'success';

            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∏—Å–∫ –º–∞—Ç—á–∞
            log('üîç –ù–∞—á–∏–Ω–∞–µ–º –ø–æ–∏—Å–∫ –º–∞—Ç—á–∞...');
            socket.emit('findMatch', {
                userId: 'test_user_' + Date.now(),
                username: 'Test Player'
            });
        });

        socket.on('connect_error', (err) => {
            log('‚ùå –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ' + err.message, true);
            statusDiv.textContent = '‚ùå –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è: ' + err.message;
            statusDiv.className = 'error';
        });

        socket.on('disconnect', (reason) => {
            log('‚ö†Ô∏è –û—Ç–∫–ª—é—á–µ–Ω –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞: ' + reason, true);
            statusDiv.textContent = '‚ö†Ô∏è –û—Ç–∫–ª—é—á–µ–Ω: ' + reason;
            statusDiv.className = 'pending';
        });

        socket.on('searching', () => {
            log('üîç –ò—â–µ–º –æ–ø–ø–æ–Ω–µ–Ω—Ç–∞...');
        });

        socket.on('gameStart', (data) => {
            log('üéÆ –ú–∞—Ç—á –Ω–∞–π–¥–µ–Ω!');
            log('Room ID: ' + data.roomId);
            log('Seed: ' + data.seed);
            log('Opponent: ' + data.opponent.username);
            statusDiv.textContent = 'üéÆ –ú–∞—Ç—á –Ω–∞–π–¥–µ–Ω! –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç!';
            statusDiv.className = 'success';
        });

        socket.on('countdown', (seconds) => {
            log('‚è±Ô∏è –û—Ç—Å—á—ë—Ç: ' + seconds);
        });

        // –¢–∞–π–º–∞—É—Ç –Ω–∞ —Å–ª—É—á–∞–π –¥–æ–ª–≥–æ–≥–æ –æ–∂–∏–¥–∞–Ω–∏—è
        setTimeout(() => {
            if (socket.connected) {
                log('‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ –≤—Ç–æ—Ä–æ–≥–æ –∏–≥—Ä–æ–∫–∞... (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ)');
            }
        }, 3000);
    </script>
</body>
</html>
