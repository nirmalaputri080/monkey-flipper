# üèÜ –¢–£–†–ù–ò–†–ù–ê–Ø –°–ò–°–¢–ï–ú–ê - –î–û–ö–£–ú–ï–ù–¢–ê–¶–ò–Ø

## ‚úÖ –ß–¢–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

### 1. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (3 —Ç–∞–±–ª–∏—Ü—ã)

#### `tournaments` - —Ç—É—Ä–Ω–∏—Ä—ã
```sql
- id: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
- name: –Ω–∞–∑–≤–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞
- description: –æ–ø–∏—Å–∞–Ω–∏–µ
- entry_fee_ton: –≤—Å—Ç—É–ø–∏—Ç–µ–ª—å–Ω—ã–π –≤–∑–Ω–æ—Å (TON)
- prize_pool_ton: —Ç–µ–∫—É—â–∏–π –ø—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥
- platform_fee_percent: –∫–æ–º–∏—Å—Å–∏—è –ø–ª–æ—â–∞–¥–∫–∏ (10-15%)
- status: upcoming/active/finished
- start_time: –≤—Ä–µ–º—è –Ω–∞—á–∞–ª–∞
- end_time: –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è
- max_participants: –ª–∏–º–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- prize_distribution: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–æ–≤ (JSON)
```

#### `tournament_participants` - —É—á–∞—Å—Ç–Ω–∏–∫–∏
```sql
- tournament_id: ID —Ç—É—Ä–Ω–∏—Ä–∞
- user_id: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- username: –∏–º—è
- best_score: –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- attempts: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫
- paid_entry: –æ–ø–ª–∞—á–µ–Ω –ª–∏ –≤–∑–Ω–æ—Å
- auto_renew: –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ
```

#### `tournament_prizes` - –≤—ã–ø–ª–∞—á–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑—ã
```sql
- tournament_id: ID —Ç—É—Ä–Ω–∏—Ä–∞
- user_id: ID –ø–æ–±–µ–¥–∏—Ç–µ–ª—è
- place: –∑–∞–Ω—è—Ç–æ–µ –º–µ—Å—Ç–æ
- prize_ton: —Å—É–º–º–∞ –ø—Ä–∏–∑–∞
- paid: –≤—ã–ø–ª–∞—á–µ–Ω –ª–∏
```

---

## 2. API Endpoints

### GET `/api/tournaments/active`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤
```json
{
  "success": true,
  "tournaments": [...]
}
```

### GET `/api/tournaments/:tournamentId`
–î–µ—Ç–∞–ª–∏ —Ç—É—Ä–Ω–∏—Ä–∞ —Å –ª–∏–¥–µ—Ä–±–æ—Ä–¥–æ–º

### POST `/api/tournaments/:tournamentId/join`
–í—Å—Ç—É–ø–∏—Ç—å –≤ —Ç—É—Ä–Ω–∏—Ä
```json
{
  "userId": "123",
  "username": "player",
  "autoRenew": false
}
```

### POST `/api/tournaments/:tournamentId/submit-score`
–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```json
{
  "userId": "123",
  "score": 5000
}
```

### POST `/api/tournaments/:tournamentId/finalize`
–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä (admin)
```json
{
  "adminKey": "your-secret-key"
}
```

### GET `/api/tournaments/my/:userId`
–ú–æ–∏ —Ç—É—Ä–Ω–∏—Ä—ã

---

## 3. UI (TournamentScene)

### –§—É–Ω–∫—Ü–∏–∏:
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –∞–∫—Ç–∏–≤–Ω—ã—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤
- ‚úÖ –ü—Ä–æ—Å–º–æ—Ç—Ä –º–æ–∏—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤
- ‚úÖ –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ —Ç—É—Ä–Ω–∏—Ä (—Å –æ–ø–ª–∞—Ç–æ–π –≤–∑–Ω–æ—Å–∞)
- ‚úÖ –ó–∞–ø—É—Å–∫ –∏–≥—Ä—ã –≤ —Ä–µ–∂–∏–º–µ —Ç—É—Ä–Ω–∏—Ä–∞
- ‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–∏–∑–æ–≤–æ–≥–æ —Ñ–æ–Ω–¥–∞
- ‚úÖ –¢–∞–π–º–µ—Ä –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è
- ‚úÖ –õ–∏–¥–µ—Ä–±–æ—Ä–¥ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

### –ù–∞–≤–∏–≥–∞—Ü–∏—è:
```
–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí üèÜ –¢—É—Ä–Ω–∏—Ä—ã
  ‚îú‚îÄ –ê–∫—Ç–∏–≤–Ω—ã–µ (–≤—Å–µ —Ç—É—Ä–Ω–∏—Ä—ã)
  ‚îî‚îÄ –ú–æ–∏ (—Ç—É—Ä–Ω–∏—Ä—ã –≥–¥–µ —è —É—á–∞—Å—Ç–≤—É—é)
```

---

## 4. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –ö—Ä–æ–Ω-–∑–∞–¥–∞—á–∞ `tournament-cron.js`
**–ß–∞—Å—Ç–æ—Ç–∞**: –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
**–§—É–Ω–∫—Ü–∏—è**: –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∏—Å—Ç–µ–∫—à–∏—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤ –∏ –≤—ã–ø–ª–∞—Ç–∞ –ø—Ä–∏–∑–æ–≤

```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ cron
crontab -e

# –î–æ–±–∞–≤–∏—Ç—å —Å—Ç—Ä–æ–∫—É:
*/5 * * * * cd /path/to/monkey-flipper-api && node tournament-cron.js >> cron.log 2>&1
```

**–ò–ª–∏ —á–µ—Ä–µ–∑ Render Cron Jobs**:
- Dashboard ‚Üí Cron Jobs ‚Üí New Cron Job
- Command: `node tournament-cron.js`
- Schedule: `*/5 * * * *`

---

## 5. –ú–µ—Ö–∞–Ω–∏–∫–∞ —Ä–∞–±–æ—Ç—ã

### –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª —Ç—É—Ä–Ω–∏—Ä–∞:

1. **–°–æ–∑–¥–∞–Ω–∏–µ** (upcoming)
   - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç —Ç—É—Ä–Ω–∏—Ä
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –≤–∑–Ω–æ—Å, –ø—Ä–∏–∑—ã, –≤—Ä–µ–º—è

2. **–ê–∫—Ç–∏–≤–∞—Ü–∏—è** (active)
   - –¢—É—Ä–Ω–∏—Ä —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è
   - –ò–≥—Ä–æ–∫–∏ –ø–ª–∞—Ç—è—Ç –≤–∑–Ω–æ—Å
   - –ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ —Ä–∞—Å—Ç–µ—Ç

3. **–ò–≥—Ä–∞**
   - –£—á–∞—Å—Ç–Ω–∏–∫–∏ –∏–≥—Ä–∞—é—Ç –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–∑
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
   - –õ–∏–¥–µ—Ä–±–æ—Ä–¥ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

4. **–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ** (finished)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ –∫—Ä–æ–Ω-–∑–∞–¥–∞—á—É
   - –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–æ–≤ –ø–æ `prize_distribution`
   - –í—ã–ø–ª–∞—Ç–∞ TON –ø–æ–±–µ–¥–∏—Ç–µ–ª—è–º

### –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–∏–∑–æ–≤:

```json
{
  "1": 50,  // 1 –º–µ—Å—Ç–æ - 50%
  "2": 30,  // 2 –º–µ—Å—Ç–æ - 30%
  "3": 20   // 3 –º–µ—Å—Ç–æ - 20%
}
```

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ç–æ–ø-10:
```json
{
  "1": 40,
  "2": 20,
  "3": 10,
  "4-10": 30  // —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ø–æ—Ä–æ–≤–Ω—É
}
```

### –ö–æ–º–∏—Å—Å–∏—è –ø–ª–æ—â–∞–¥–∫–∏:
- `platform_fee_percent` = 10%
- –ò–∑ –∫–∞–∂–¥–æ–≥–æ –≤–∑–Ω–æ—Å–∞ 10% –∏–¥–µ—Ç –ø–ª–æ—â–∞–¥–∫–µ
- 90% –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –≤ prize_pool

**–ü—Ä–∏–º–µ—Ä**:
- –í–∑–Ω–æ—Å: 1 TON
- –ö –ø—Ä–∏–∑–æ–≤–æ–º—É —Ñ–æ–Ω–¥—É: 0.9 TON
- –ö–æ–º–∏—Å—Å–∏—è: 0.1 TON

---

## 6. –°–æ–∑–¥–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞

### –í—Ä—É—á–Ω—É—é (SQL):
```sql
INSERT INTO tournaments (
  name, description, entry_fee_ton, prize_pool_ton,
  platform_fee_percent, status, start_time, end_time,
  max_participants, prize_distribution
) VALUES (
  'Weekly Championship',
  'Compete for weekly prizes!',
  0.5,
  0,
  10,
  'active',
  NOW(),
  NOW() + INTERVAL '7 days',
  100,
  '{"1": 50, "2": 30, "3": 20}'
);
```

### –ß–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç:
```bash
cd monkey-flipper-api
node create-test-tournament.js
```

---

## 7. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞ TON –ø–µ—Ä–µ–¥ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ–º
- ‚úÖ –ù–µ–ª—å–∑—è –≤—Å—Ç—É–ø–∏—Ç—å –¥–≤–∞–∂–¥—ã
- ‚úÖ –õ–∏–º–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ —Ç—É—Ä–Ω–∏—Ä –∞–∫—Ç–∏–≤–µ–Ω
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏ (FOR UPDATE)
- ‚úÖ –ö–æ–º–∏—Å—Å–∏—è –ø–ª–æ—â–∞–¥–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Ç–∞–µ—Ç—Å—è

### –ó–∞—â–∏—Ç–∞ –æ—Ç —á–∏—Ç–æ–≤:
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ—Ç –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- –ò—Å—Ç–æ—Ä–∏—è –ø–æ–ø—ã—Ç–æ–∫ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è

---

## 8. –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ

### –û–ø—Ü–∏—è `auto_renew`:
```javascript
// –ü—Ä–∏ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–∏:
autoRenew: true

// –ü—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —Ç—É—Ä–Ω–∏—Ä–∞:
- –ï—Å–ª–∏ auto_renew = true
- –ò –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ TON
- ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—Å—Ç—É–ø–∞–µ—Ç –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ç—É—Ä–Ω–∏—Ä
```

**TODO**: –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –∞–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏—è –≤ –∫—Ä–æ–Ω-–∑–∞–¥–∞—á–µ

---

## 9. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### 1. –°–æ–∑–¥–∞—Ç—å —Ç—É—Ä–Ω–∏—Ä:
```bash
node create-test-tournament.js
```

### 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∏–≥—Ä–µ:
- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ‚Üí üèÜ –¢—É—Ä–Ω–∏—Ä—ã
- –í–∏–¥–µ—Ç—å —Ç—É—Ä–Ω–∏—Ä –≤ —Å–ø–∏—Å–∫–µ
- –ù–∞–∂–∞—Ç—å JOIN

### 3. –ò–≥—Ä–∞—Ç—å:
- –ù–∞–∂–∞—Ç—å –ò–ì–†–ê–¢–¨
- –ò–≥—Ä–∞—Ç—å –æ–±—ã—á–Ω—É—é –∏–≥—Ä—É
- –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è –≤ —Ç—É—Ä–Ω–∏—Ä

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–¥–µ—Ä–±–æ—Ä–¥:
- –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –¢—É—Ä–Ω–∏—Ä—ã ‚Üí –ú–æ–∏
- –í–∏–¥–µ—Ç—å —Å–≤–æ–µ –º–µ—Å—Ç–æ –∏ —Å—á–µ—Ç

### 5. –ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç—É—Ä–Ω–∏—Ä:
```bash
node tournament-cron.js
```

### 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏–∑—ã:
```sql
SELECT * FROM tournament_prizes WHERE tournament_id = 1;
SELECT ton_balance FROM wallets WHERE user_id = 'winner_id';
```

---

## 10. Roadmap

### –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è (v1.0):
- ‚úÖ –ë–∞–∑–æ–≤–∞—è —Ç—É—Ä–Ω–∏—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- ‚úÖ –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ —Å –æ–ø–ª–∞—Ç–æ–π
- ‚úÖ –õ–∏–¥–µ—Ä–±–æ—Ä–¥
- ‚úÖ –ê–≤—Ç–æ–∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ
- ‚úÖ –í—ã–ø–ª–∞—Ç–∞ –ø—Ä–∏–∑–æ–≤

### –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (v2.0):
- [ ] –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–∏—è
- [ ] –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö
- [ ] –ò—Å—Ç–æ—Ä–∏—è –≤—Å–µ—Ö —Ç—É—Ä–Ω–∏—Ä–æ–≤
- [ ] –¢—É—Ä–Ω–∏—Ä—ã –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é (–µ–∂–µ–¥–Ω–µ–≤–Ω—ã–µ, –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–µ)
- [ ] –†–∞–∑–Ω—ã–µ —Ç–∏–ø—ã —Ç—É—Ä–Ω–∏—Ä–æ–≤ (–±—ã—Å—Ç—Ä—ã–µ, –º–∞—Ä–∞—Ñ–æ–Ω—ã)
- [ ] –ë–æ–Ω—É—Å–Ω—ã–µ —Ç—É—Ä–Ω–∏—Ä—ã –±–µ–∑ –≤–∑–Ω–æ—Å–∞
- [ ] –ö–æ–º–∞–Ω–¥ÔøΩÔøΩ—ã–µ —Ç—É—Ä–Ω–∏—Ä—ã

---

## 11. –ú–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏—è

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ—Ö–æ–¥–∞:
1. **–ö–æ–º–∏—Å—Å–∏—è —Å —Ç—É—Ä–Ω–∏—Ä–æ–≤**: 10-15% –æ—Ç –≤—Å–µ—Ö –≤–∑–Ω–æ—Å–æ–≤
2. **–°–ø–æ–Ω—Å–æ—Ä—Å–∫–∏–µ —Ç—É—Ä–Ω–∏—Ä—ã**: –ø–∞—Ä—Ç–Ω–µ—Ä—ã –¥–æ–±–∞–≤–ª—è—é—Ç –≤ prize pool
3. **VIP —Ç—É—Ä–Ω–∏—Ä—ã**: –≤—ã—Å–æ–∫–∏–µ —Å—Ç–∞–≤–∫–∏, —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –¥–æ—Å—Ç—É–ø

### –ü—Ä–æ–≥–Ω–æ–∑:
- 100 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ √ó 0.5 TON = 50 TON –≤–∑–Ω–æ—Å–æ–≤
- –ö–æ–º–∏—Å—Å–∏—è 10% = 5 TON
- –ü—Ä–∏–∑–æ–≤–æ–π —Ñ–æ–Ω–¥ = 45 TON
- **–î–æ—Ö–æ–¥ –ø–ª–æ—â–∞–¥–∫–∏: 5 TON –∑–∞ —Ç—É—Ä–Ω–∏—Ä**

---

## üéØ –°–¢–ê–¢–£–°: –ì–û–¢–û–í–û –ö –î–ï–ü–õ–û–Æ ‚úÖ

–¢—É—Ä–Ω–∏—Ä–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!
